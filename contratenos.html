<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contrátenos - ARMAVE</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Alegreya+Sans:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles/styles.css" />
    <link rel="icon" href="images/logo.png" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Alertify.js scripts y css-->
    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/alertify.min.js"></script>

    <!-- CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/css/alertify.min.css"
    />
    <!-- Default theme -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/css/themes/default.min.css"
    />
    <!-- Semantic UI theme -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/css/themes/semantic.min.css"
    />
    <!-- Bootstrap theme -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/alertifyjs@1.14.0/build/css/themes/bootstrap.min.css"
    />
    <script src="scripts/alerts.js"></script>

    <script src="scripts/carrito.js"></script>
  </head>
  <body style="background-color: #9adac8">
    <!-- Cabecera -->
    <header class="bg-white text-dark text-center py-3">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-12 col-lg-2">
            <a href="index.html"
              ><img
                src="images/image-17.png"
                alt="Logo de la empresa"
                class="img-fluid"
                width="100"
            /></a>
          </div>
          <div class="col-12 col-lg-10">
            <nav
              class="navbar navbar-expand-lg navbar-light bg-white justify-content-between"
            >
              <button
                class="navbar-toggler text-dark"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarNav"
              >
                <span class="navbar-toggler-icon"></span>
              </button>
              <div
                class="navbar-collapse collapse justify-content-end"
                id="navbarNav"
              >
                <ul class="navbar-nav ms-auto">
                  <li class="nav-item">
                    <a class="nav-link" href="index.html">Inicio</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="sobre-nosotros.html"
                      >Sobre Nosotros</a
                    >
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="servicios.html">Servicios</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="contratenos.html">Contrátenos</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="ayuda.html">Ayuda</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="grafico.html">Gráfico</a>
                  </li>
                  <li class="nav-item">
                    <a
                      class="nav-link"
                      href="#loginModal"
                      data-bs-toggle="modal"
                      >Iniciar Sesión</a
                    >
                  </li>
                  <li class="nav-item">
                    <a
                      class="nav-link"
                      href="#registerModal"
                      data-bs-toggle="modal"
                      >Registrarse</a
                    >
                  </li>
                  <!-- Carrito -->
                  <li class="nav-item">
                    <a
                      class="nav-link"
                      href="#"
                      id="carritoLink"
                      data-bs-toggle="modal"
                      data-bs-target="#carritoModal"
                    >
                      <img
                        src="images/carrito.svg"
                        alt="Carrito"
                        style="width: 1.5rem; height: 1.5rem"
                      />
                      <span id="carritoCount" class="badge bg-danger">0</span>
                    </a>
                  </li>
                </ul>
              </div>
            </nav>
          </div>
        </div>
      </div>
    </header>

    <!-- Sección Contrátenos -->
    <section id="contratenos" class="bg-custom text-light py-5">
      <div class="container">
        <h2 class="text-center mb-4">Contrátenos</h2>
        <div class="row">
          <div class="col-12 mb-4">
            <p>
              ¿Estás interesado en contratar nuestros servicios o tienes alguna
              duda? Por favor, completa el siguiente formulario y nos pondremos
              en contacto contigo lo antes posible.
            </p>
          </div>
          <!-- Formulario de contacto -->
          <form id="contactForm" class="row g-3">
            <div class="col-md-6">
              <label for="nombre" class="form-label">Nombre</label>
              <input
                type="text"
                class="form-control"
                id="nombre"
                name="nombre"
                required
              />
            </div>
            <div class="col-md-6">
              <label for="correo" class="form-label">Correo Electrónico</label>
              <input
                type="email"
                class="form-control"
                id="correo"
                name="correo"
                required
              />
            </div>
            <div class="col-md-6">
              <label for="telefono" class="form-label"
                >Número de Teléfono</label
              >
              <input
                type="tel"
                class="form-control"
                id="telefono"
                name="telefono"
                required
              />
            </div>
            <div class="col-md-6">
              <label for="presupuesto" class="form-label">Presupuesto</label>
              <input
                type="number"
                class="form-control"
                id="presupuesto"
                name="presupuesto"
                placeholder="Introduce tu presupuesto (en €)"
                required
              />
            </div>
            <div class="col-12">
              <label for="mensaje" class="form-label">Mensaje</label>
              <textarea
                class="form-control"
                id="mensaje"
                name="mensaje"
                rows="5"
                required
              ></textarea>
            </div>
            <div class="col-12">
              <button
                type="button"
                class="btn btn-primary"
                id="mostrarResumenBtn"
              >
                Mostrar Resumen
              </button>
            </div>
          </form>
          <div class="col-12 my-4">
            <hr />
          </div>
          <!-- Mapa de Ubicación -->
          <div class="col-md-6 mb-4">
            <h4>Ubicación</h4>
            <iframe
              width="100%"
              height="300"
              frameborder="0"
              style="border: 0"
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3169.834708655941!2d-6.00965844084506!3d37.39374107496211!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd126c117471419f%3A0xed36a7d3b48f3117!2sEscuela%20Superior%20de%20Hosteleria%20de%20Sevilla!5e0!3m2!1ses!2ses!4v1709579310664!5m2!1ses!2ses"
            ></iframe>
          </div>

          <div class="col-md-6">
            <!-- Opciones de pago -->
            <div>
              <h4>Opciones de Pago</h4>
              <p>
                Ofrecemos métodos de pago en tiempo real como tarjetas de
                crédito, Bizum y transferencia bancaria para garantizar la
                confirmación inmediata de tus reservas.
              </p>
            </div>
            <div class="col-12 my-4">
              <hr />
            </div>
            <!-- Política de Privacidad -->
            <div>
              <h4>Política de Privacidad</h4>
              <p>
                Tus datos están seguros con nosotros. Consulta nuestra política
                para más detalles sobre cómo manejamos tu información personal.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal de Resumen del Evento -->
    <div
      class="modal fade"
      id="resumenModal"
      tabindex="-1"
      aria-labelledby="resumenModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="resumenModalLabel">
              Resumen de tu Evento
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p><strong>Nombre:</strong> <span id="nombreResumen"></span></p>
            <p>
              <strong>Correo Electrónico:</strong>
              <span id="correoResumen"></span>
            </p>
            <p>
              <strong>Número de Teléfono:</strong>
              <span id="telefonoResumen"></span>
            </p>
            <p>
              <strong>Presupuesto:</strong>
              <span id="presupuestoResumen"></span> €
            </p>
            <p>
              <strong>Servicio Seleccionado:</strong>
              <span id="servicioResumen"></span>
            </p>
            <p><strong>Mensaje:</strong> <span id="mensajeResumen"></span></p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="confirmarReservaBtn"
            >
              Confirmar y Proceder al Pago
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Iniciar Sesión -->
    <div
      class="modal fade"
      id="loginModal"
      tabindex="-1"
      aria-labelledby="loginModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loginModalLabel">Iniciar Sesión</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="loginForm" action="php/login.php" method="POST">
              <div class="mb-3">
                <label for="username">Usuario</label>
                <input
                  type="text"
                  class="form-control"
                  id="username"
                  name="username"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="password">Contraseña</label>
                <input
                  type="password"
                  class="form-control"
                  id="password"
                  name="password"
                  required
                />
              </div>
              <button type="submit" class="btn btn-primary">
                Iniciar Sesión
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Registrarse -->
    <div
      class="modal fade"
      id="registerModal"
      tabindex="-1"
      aria-labelledby="registerModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="registerModalLabel">Registrarse</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="registerForm">
              <div class="mb-3">
                <label for="registerName">Nombre</label>
                <input
                  type="text"
                  class="form-control"
                  id="registerName"
                  name="username"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="registerEmail">Correo Electrónico</label>
                <input
                  type="email"
                  class="form-control"
                  id="registerEmail"
                  name="email"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="registerPassword">Contraseña</label>
                <input
                  type="password"
                  class="form-control"
                  id="registerPassword"
                  name="password"
                  required
                />
              </div>
              <button type="submit" class="btn btn-primary">Registrarse</button>
            </form>
            <div id="responseMessage" class="mt-3"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal del carrito -->
    <div
      class="modal fade"
      id="carritoModal"
      tabindex="-1"
      aria-labelledby="carritoModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="carritoModalLabel">
              Carrito de Compras
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Cerrar"
            ></button>
          </div>
          <div class="modal-body">
            <h6>Artículos en tu carrito:</h6>
            <ul id="listaCarrito" class="list-group">
              <!-- Aquí se agregarán los artículos dinámicamente -->
            </ul>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cerrar
            </button>
            <button type="button" class="btn btn-primary" id="finalizarCompra">
              Finalizar Compra
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Pie de página -->
    <footer
      class="bg-white text-dark text-center py-3"
      style="position: fixed; bottom: 0; width: 100%"
    >
      <div class="container">
        <p>&copy; 2024 ARMAVE S.A. Todos los derechos reservados.</p>
      </div>
    </footer>

    <!-- Scripts necesarios para el funcionamiento del modal -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>

    <script>
      document
        .getElementById("loginForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Evita el envío del formulario tradicional

          const username = document.getElementById("username").value.trim();
          const password = document.getElementById("password").value.trim();

          if (!username || !password) {
            alerta(
              "Campos incompletos",
              "Por favor, complete todos los campos."
            );
            return;
          }

          // Enviar los datos a través de AJAX
          const formData = new FormData();
          formData.append("username", username);
          formData.append("password", password);

          fetch("php/login.php", {
            method: "POST",
            body: formData,
          })
            .then((response) => response.json())
            .then((data) => {
              if (data.status === "success") {
                // Redirigir según el mensaje recibido (la URL de redirección)
                window.location.href = data.message;
              } else {
                // Mostrar mensaje de error
                alerta("Error producido", data.message);
              }
            })
            .catch((error) => {
              console.error("Error al procesar la solicitud:", error);
              alerta(
                "Error producido",
                "Hubo un error al procesar la solicitud."
              );
            });
        });
    </script>
    <script>
      $(document).ready(function () {
        $("#registerForm").on("submit", function (e) {
          e.preventDefault(); // Prevenir el comportamiento predeterminado del formulario

          // Obtener los datos del formulario
          var formData = $(this).serialize();

          $.ajax({
            url: "register.php", // La URL a donde se enviarán los datos
            type: "POST",
            data: formData, // Los datos del formulario
            dataType: "json", // Especificamos que esperamos un JSON como respuesta
            success: function (response) {
              // Mostrar el mensaje de respuesta
              $("#responseMessage").html(response.message);

              // Si el registro es exitoso, limpiamos el formulario y cerramos el modal
              if (response.status === "success") {
                $("#registerForm")[0].reset(); // Limpiar los campos del formulario
                $("#registerModal").modal("hide"); // Cerrar el modal
              }
            },
            error: function () {
              $("#responseMessage").html(
                "Hubo un error al procesar la solicitud."
              );
            },
          });
        });
      });
    </script>
    <script>
      // Función para agregar el evento al carrito
      function agregarEventoAlCarrito() {
        // Obtener los datos del modal de resumen
        let nombre = document.getElementById("nombreResumen").textContent;
        let correo = document.getElementById("correoResumen").textContent;
        let telefono = document.getElementById("telefonoResumen").textContent;
        let presupuesto =
          document.getElementById("presupuestoResumen").textContent;
        let servicio = document.getElementById("servicioResumen").textContent;
        let mensaje = document.getElementById("mensajeResumen").textContent;

        // Crear el objeto con los detalles del evento
        let evento = {
          nombre,
          correo,
          telefono,
          presupuesto,
          servicio,
          mensaje,
        };

        agregarAlCarritoAjax(evento.nombre, evento.servicio, evento.presupuesto)
          .then((resultado) => {
            if (resultado.status == "success") {
              obtenerCarrito()
                .then((resultadoCarrito) => {
                  if (resultadoCarrito.status == "success") {
                    actualizarContadorCarrito(resultadoCarrito.carrito.length);
                  } else {
                    actualizarContadorCarrito(0);
                  }
                })
                .catch((error) => {
                  console.error(error);
                });
            } else {
              alerta("Error producido ", resultado.message);
            }
          })
          .catch((error) => {
            console.error(error);
          });

        // Cerrar el modal
        $("#resumenModal").modal("hide");
      }

      // Event listener para el botón de confirmación
      document
        .getElementById("confirmarReservaBtn")
        .addEventListener("click", function () {
          agregarEventoAlCarrito();
          // Redirigir al pago o a otra página si es necesario
          window.location.href = "pago.html";
        });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Referencias al formulario, botón y campos del modal
        const form = document.getElementById("contactForm");
        const mostrarResumenBtn = document.getElementById("mostrarResumenBtn");
        const nombreResumen = document.getElementById("nombreResumen");
        const correoResumen = document.getElementById("correoResumen");
        const telefonoResumen = document.getElementById("telefonoResumen");
        const presupuestoResumen =
          document.getElementById("presupuestoResumen");
        const mensajeResumen = document.getElementById("mensajeResumen");

        // Manejar el evento de mostrar resumen
        mostrarResumenBtn.addEventListener("click", () => {
          // Obtener los valores de los campos del formulario
          const nombre = form.nombre.value.trim();
          const correo = form.correo.value.trim();
          const telefono = form.telefono.value.trim();
          const presupuesto = form.presupuesto.value.trim();
          const mensaje = form.mensaje.value.trim();

          // Validar que todos los campos obligatorios están completos
          if (!nombre || !correo || !telefono || !presupuesto || !mensaje) {
            alert("Por favor, completa todos los campos antes de continuar.");
            return;
          }

          // Asignar los valores al modal
          nombreResumen.textContent = nombre;
          correoResumen.textContent = correo;
          telefonoResumen.textContent = telefono;
          presupuestoResumen.textContent = presupuesto;
          mensajeResumen.textContent = mensaje;

          // Mostrar el modal
          const resumenModal = new bootstrap.Modal(
            document.getElementById("resumenModal")
          );
          resumenModal.show();
        });

        // Manejar la acción de confirmar
        const confirmarReservaBtn = document.getElementById(
          "confirmarReservaBtn"
        );
        confirmarReservaBtn.addEventListener("click", () => {
          // Mostrar un mensaje de confirmación
          alert("¡Mensaje enviado! Serás redirigido a la página de inicio.");

          // Redirigir a la página de inicio después de cerrar el pop-up
          window.location.href = "index.html";
        });
      });
    </script>
  </body>
</html>
